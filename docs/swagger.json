{
    "swagger": "2.0",
    "info": {
        "description": "An API to encapsulate Happy Path functionality",
        "title": "Happy API",
        "contact": {}
    },
    "host": "localhost:3001",
    "basePath": "/",
    "paths": {
        "/health": {
            "get": {
                "consumes": [
                    "*/*"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "root"
                ],
                "summary": "Check that the server is up.",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.Health"
                        }
                    }
                }
            }
        },
        "/v1/config/copy": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Copy a single config key/value from one env/stack to another",
                "parameters": [
                    {
                        "description": "Specification of the app, source env/stack, destination env/stack, and key to copy",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppConfigDiff"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedResolvedAppConfig"
                        }
                    }
                }
            }
        },
        "/v1/config/copyDiff": {
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Copy the missing configs from one env/stack to another",
                "parameters": [
                    {
                        "description": "Specification of the app, source env/stack, and destination env/stack",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppConfigDiff"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppConfigsWithCount"
                        }
                    }
                }
            }
        },
        "/v1/config/diff": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Get a list of config keys that exist in one env/stack and not another",
                "parameters": [
                    {
                        "description": "Specification of the app, source env/stack, and destination env/stack",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppConfigDiff"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.ConfigDiff"
                        }
                    }
                }
            }
        },
        "/v1/config/dump": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Fetch all configs for a given app/env (including all stacks) (stack overrides are not applied)",
                "parameters": [
                    {
                        "description": "Specification of the app, env, and optional stack",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppMetadata"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppConfigsWithCount"
                        }
                    }
                }
            }
        },
        "/v1/configs/": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Retrieve resolved configs for the given app/env/stack",
                "parameters": [
                    {
                        "description": "Specification of the app, env, and stack (optional)",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppMetadata"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedResolvedAppConfigsWithCount"
                        }
                    }
                }
            },
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Retrieve resolved configs for the given app/env/stack",
                "parameters": [
                    {
                        "description": "Specification of the app, env, stack (optional), app config key, and app config value",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppConfig"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppConfig"
                        }
                    }
                }
            }
        },
        "/v1/configs/{key}": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Retrieve a single resolved config for the given app/env/stack and key",
                "parameters": [
                    {
                        "description": "Specification of the app, env, and stack (optional)",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppMetadata"
                        }
                    },
                    {
                        "type": "string",
                        "description": "The app config key to retrieve",
                        "name": "key",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedResolvedAppConfig"
                        }
                    }
                }
            },
            "delete": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "config"
                ],
                "summary": "Delete a single resolved config for the given app/env/stack and key",
                "parameters": [
                    {
                        "description": "Specification of the app, env, and stack (optional)",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppMetadata"
                        }
                    },
                    {
                        "type": "string",
                        "description": "The app config key to delete",
                        "name": "key",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "record will be the deleted record (or null if nothing was deleted)",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppConfig"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/response.ValidationError"
                        }
                    }
                }
            }
        },
        "/v1/stacks/": {
            "get": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "stacks"
                ],
                "summary": "Retrieve app stacks for the given app/env/stack",
                "parameters": [
                    {
                        "description": "Specification of the app and env",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/payload.AppMetadata"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppStacksWithCount"
                        }
                    }
                }
            },
            "put": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "stacks"
                ],
                "summary": "Updates the enabled column of a stack for the given app/env/stack",
                "parameters": [
                    {
                        "description": "Specification of the stack",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/model.AppStack"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppStack"
                        }
                    }
                }
            },
            "post": {
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "stacks"
                ],
                "summary": "Create an app stack given app/env/stack",
                "parameters": [
                    {
                        "description": "Specification of the stack",
                        "name": "payload",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/model.AppStack"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/response.WrappedAppStack"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "model.AppStack": {
            "type": "object",
            "required": [
                "app_name",
                "environment"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "enabled": {
                    "type": "boolean"
                },
                "environment": {
                    "type": "string"
                },
                "stack": {
                    "type": "string"
                }
            }
        },
        "payload.AppConfig": {
            "type": "object",
            "required": [
                "app_name",
                "environment",
                "key",
                "value"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "environment": {
                    "type": "string"
                },
                "key": {
                    "type": "string"
                },
                "stack": {
                    "type": "string"
                },
                "value": {
                    "type": "string"
                }
            }
        },
        "payload.AppConfigDiff": {
            "type": "object",
            "required": [
                "app_name",
                "destination_environment",
                "source_environment"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "destination_environment": {
                    "type": "string"
                },
                "destination_stack": {
                    "type": "string"
                },
                "source_environment": {
                    "type": "string"
                },
                "source_stack": {
                    "type": "string"
                }
            }
        },
        "payload.AppMetadata": {
            "type": "object",
            "required": [
                "app_name",
                "environment"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "environment": {
                    "type": "string"
                },
                "stack": {
                    "type": "string"
                }
            }
        },
        "response.AppConfig": {
            "description": "App config key/value pair with additional metadata",
            "type": "object",
            "required": [
                "app_name",
                "environment",
                "key",
                "value"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "environment": {
                    "type": "string"
                },
                "key": {
                    "type": "string"
                },
                "stack": {
                    "type": "string"
                },
                "value": {
                    "type": "string"
                }
            }
        },
        "response.ConfigDiff": {
            "description": "Object denoting which app config keys are missing from the destination env/stack",
            "type": "object",
            "properties": {
                "missing_keys": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "example": [
                        "SOME_KEY",
                        "ANOTHER_KEY"
                    ]
                }
            }
        },
        "response.Health": {
            "description": "Health info",
            "type": "object",
            "properties": {
                "route": {
                    "type": "string",
                    "example": "/"
                },
                "status": {
                    "type": "string",
                    "example": "OK"
                }
            }
        },
        "response.ResolvedAppConfig": {
            "description": "App config key/value pair with additional metadata and \"source\"",
            "type": "object",
            "required": [
                "app_name",
                "environment",
                "key",
                "value"
            ],
            "properties": {
                "app_name": {
                    "type": "string"
                },
                "environment": {
                    "type": "string"
                },
                "key": {
                    "type": "string"
                },
                "source": {
                    "type": "string"
                },
                "stack": {
                    "type": "string"
                },
                "value": {
                    "type": "string"
                }
            }
        },
        "response.ValidationError": {
            "type": "object",
            "properties": {
                "failed_field": {
                    "description": "the field that failed to be validated",
                    "type": "string"
                },
                "message": {
                    "description": "a description of the error that occured",
                    "type": "string"
                }
            }
        },
        "response.WrappedAppConfig": {
            "description": "App config key/value pair wrapped in \"record\" key",
            "type": "object",
            "properties": {
                "record": {
                    "$ref": "#/definitions/response.AppConfig"
                }
            }
        },
        "response.WrappedAppConfigsWithCount": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 1
                },
                "records": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/response.AppConfig"
                    }
                }
            }
        },
        "response.WrappedAppStack": {
            "type": "object",
            "properties": {
                "record": {
                    "$ref": "#/definitions/model.AppStack"
                }
            }
        },
        "response.WrappedAppStacksWithCount": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 1
                },
                "records": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/model.AppStack"
                    }
                }
            }
        },
        "response.WrappedResolvedAppConfig": {
            "description": "App config key/value pair wrapped in \"record\" key",
            "type": "object",
            "properties": {
                "record": {
                    "$ref": "#/definitions/response.ResolvedAppConfig"
                }
            }
        },
        "response.WrappedResolvedAppConfigsWithCount": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 1
                },
                "records": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/response.ResolvedAppConfig"
                    }
                }
            }
        }
    }
}